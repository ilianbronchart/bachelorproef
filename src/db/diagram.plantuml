@startuml Database Diagram
' Define the Recording entity (with metadata)
entity "Recording" as Recording {
  * uuid : string <<PK>>
  --
  visible_name : string
  participant  : string
  created      : datetime
  duration     : string
  folder_name  : string
  scene_video_url : string
  gaze_data_url   : string
}

' Define the SimRoom entity
entity "SimRoom" as SimRoom {
  * id   : int <<PK>>
  --
  name : string
}

' Each SimRoom defines several classes (for labeling objects)
entity "SimRoomClass" as SimRoomClass {
  * id         : int <<PK>>
  --
  sim_room_id : int <<FK>>
  class_name  : string
}

' Calibration recordings are linked to a specific SimRoom and a Recording
entity "CalibrationRecording" as CalibrationRecording {
  * id             : int <<PK>>
  --
  sim_room_id     : int <<FK>>
  recording_uuid  : string <<FK>>
}

' Each calibration recording contains several annotations.
' Each Annotation refers to a specific SimRoomClass.
entity "Annotation" as Annotation {
  * id                      : int <<PK>>
  --
  calibration_recording_id  : int <<FK>>
  sim_room_class_id         : int <<FK>>
}

' Each Annotation has one or more PointLabels (with coordinates and a label flag)
entity "PointLabel" as PointLabel {
  * id           : int <<PK>>
  --
  annotation_id  : int <<FK>>
  x              : float
  y              : float
  label          : bool   ' true for positive segmentation, false for negative
}

' Relationships

' A SimRoom can have many CalibrationRecordings
SimRoom ||--o{ CalibrationRecording : "has"

' Each CalibrationRecording is linked to one Recording (metadata)
Recording ||--o{ CalibrationRecording : "is linked to"

' A CalibrationRecording contains one or more Annotations
CalibrationRecording ||--o{ Annotation : "contains"

' An Annotation is labeled by a class defined in a SimRoom
SimRoomClass ||--o{ Annotation : "labels"

' A SimRoom defines many SimRoomClasses
SimRoom ||--o{ SimRoomClass : "defines"

' Each Annotation has one or more PointLabels
Annotation ||--o{ PointLabel : "has"
@enduml