<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eyetracking</title>
    <script src="https://unpkg.com/htmx.org@2.0.4"
            integrity="sha384-HGfztofotfshcF7+8n44JQL2oJmowVChPTg48S+jvZoztPfvwD79OC/LTtG6dMp+"
            crossorigin="anonymous"></script>
    <script src="https://unpkg.com/htmx-ext-response-targets@2.0.0/response-targets.js"></script>
    <script src="https://cdn.datatables.net/v/dt/jq-3.7.0/dt-2.2.1/b-3.2.0/datatables.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
          crossorigin="anonymous">
    <!-- Option 1: Include in HTML -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
    <link href="{{ url_for('static', path='/css/app.css') }}" rel="stylesheet">
    <link href="https://cdn.datatables.net/v/dt/jq-3.7.0/dt-2.2.1/b-3.2.0/datatables.min.css"
          rel="stylesheet">
  </head>
  <body class="d-flex">
    <div class="d-flex flex-column flex-shrink-0 p-3 text-white bg-dark"
         style="width: 280px;
                min-height: 100vh">
      <a href="/"
         class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
        <svg class="bi me-2" width="40" height="32">
          <use xlink:href="#bootstrap"></use>
        </svg>
        <span class="fs-4">Sidebar</span>
      </a>
      <hr>
      <ul class="nav nav-pills flex-column mb-auto">
        <li class="nav-item">
          <a href="/recording"
             id="nav-browse"
             class="nav-link"
             aria-current="page"
             hx-get="/recording"
             hx-trigger="click"
             hx-swap="innerHTML"
             hx-target="#main-content"
             hx-push-url="true">
            <i class="bi bi-search"></i>
            Browse Recordings
          </a>
        </li>
      </ul>
      <hr>
      <div id="connection-status"
           hx-get="/glasses/connection"
           hx-trigger="load"
           hx-target="#connection-status"
           hx-swap="outerHTML"></div>
    </div>
    <div id="main-content" class="flex-grow-1 p-3 mt-5">
      {% if content %}
        {% include content %}
      {% endif %}
    </div>
  </body>
  <script>
  function updateActiveNav() {
    // Remove active class from all nav links.
    document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));

    // Determine the active page based on the current pathname.
    if (window.location.pathname.startsWith('/recording')) {
      document.getElementById('nav-browse').classList.add('active');
    }
  }

  // Run after the initial page load.
  document.addEventListener("DOMContentLoaded", updateActiveNav);

  // Listen for htmx swaps to update nav when the content changes.
  document.body.addEventListener('htmx:afterSwap', event => {
    // Optional: Check that the swap target is the main content div.
    if (event.detail.target.id === 'main-content') {
      updateActiveNav();
    }
  });

  // Also update if the user navigates using browser history (back/forward).
  window.addEventListener('popstate', updateActiveNav);
  </script>
</html>
